(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[734],{4520:function(e,t,n){Promise.resolve().then(n.bind(n,479))},479:function(e,t,n){"use strict";n.d(t,{default:function(){return eU}});var r=n(7437),s=n(9376),i=n(2265),o=n(2381),a=n(9820),c=n(3448);let l=i.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)("textarea",{className:(0,c.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:t,...s})});l.displayName="Textarea";var d=n(7119);let u=d.Km(["owasp-top10","nist-ssdf","soc2","owasp-asvs"]),p=d.Ry({name:d.Z_().min(1,"Project name is required").max(120,"Project name must be 120 characters or fewer"),description:d.Z_().min(1,"Project description is required").max(2e3,"Description must be 2,000 characters or fewer"),stack:d.Z_().min(1,"Technology stack is required").max(1e3,"Stack description must be 1,000 characters or fewer"),structure:d.Z_().min(1,"Project structure is required").max(5e4,"Structure must be 50,000 characters or fewer"),frameworks:d.IX(u).min(1,"At least one compliance framework must be selected")});function m(e){let{currentStep:t,totalSteps:n,stepLabels:s}=e;return(0,r.jsx)("nav",{"aria-label":"Assessment progress",className:"w-full",children:(0,r.jsx)("ol",{className:"flex items-center",children:Array.from({length:n},(e,i)=>{var o;let a=i+1,l=a<t,d=a===t,u=a===n;return(0,r.jsxs)("li",{className:(0,c.cn)("flex items-center",!u&&"flex-1"),children:[(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[(0,r.jsx)("div",{className:(0,c.cn)("flex h-8 w-8 items-center justify-center rounded-full border-2 text-xs font-semibold transition-colors",l&&"border-primary bg-primary text-primary-foreground",d&&"border-primary bg-background text-primary ring-2 ring-primary/20",!l&&!d&&"border-muted-foreground/30 bg-background text-muted-foreground"),children:l?(0,r.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:3,children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}):a}),(0,r.jsx)("span",{className:(0,c.cn)("mt-1.5 whitespace-nowrap text-xs font-medium",d?"text-primary":"text-muted-foreground"),children:null!==(o=s[i])&&void 0!==o?o:"Step ".concat(a)})]}),!u&&(0,r.jsx)("div",{className:(0,c.cn)("mx-2 h-0.5 flex-1 transition-colors",l?"bg-primary":"bg-muted-foreground/20")})]},a)})})})}function f(e){let{value:t,onChange:n}=e;return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("label",{className:"text-sm font-medium",htmlFor:"project-structure",children:"Project Structure"}),t.length>0&&(0,r.jsx)(o.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>n(""),children:"Clear"})]}),(0,r.jsx)(l,{id:"project-structure",className:"min-h-[280px] font-mono text-sm",placeholder:"Paste your project structure here, e.g.:\n\nsrc/\n  app/\n    layout.tsx\n    page.tsx\n  lib/\n    auth.ts\n    db.ts\n  components/\n    header.tsx\npackage.json\ntsconfig.json\nDockerfile\n.github/\n  workflows/\n    ci.yml",value:t,onChange:e=>n(e.target.value)}),(0,r.jsxs)("p",{className:"text-right text-xs tabular-nums text-muted-foreground",children:[t.length.toLocaleString()," characters"]})]})}var h=n(9699),g=n(401);let x=i.forwardRef((e,t)=>{let{className:n,...s}=e;return(0,r.jsx)(h.fC,{ref:t,className:(0,c.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",n),...s,children:(0,r.jsx)(h.z$,{className:(0,c.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(g.Z,{className:"h-3.5 w-3.5"})})})});x.displayName=h.fC.displayName;let y=[{id:"owasp-top10",name:"OWASP Top 10",description:"Web application security risks"},{id:"nist-ssdf",name:"NIST SSDF",description:"Secure software development practices"},{id:"soc2",name:"SOC 2",description:"Trust services criteria for audit compliance"},{id:"owasp-asvs",name:"OWASP ASVS",description:"Application security verification"}];function j(e){let{selected:t,onChange:n}=e;function s(e,r){r?n([...t,e]):n(t.filter(t=>t!==e))}return(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("label",{className:"text-sm font-medium",children:"Compliance Frameworks"}),(0,r.jsx)("div",{className:"grid grid-cols-1 gap-3 sm:grid-cols-2",children:y.map(e=>{let n=t.includes(e.id);return(0,r.jsx)(a.Zb,{className:n?"cursor-pointer border-primary bg-primary/5":"cursor-pointer hover:border-muted-foreground/30",onClick:()=>s(e.id,!n),children:(0,r.jsxs)(a.aY,{className:"flex items-start gap-3 p-4",children:[(0,r.jsx)(x,{id:e.id,checked:n,onCheckedChange:t=>s(e.id,!0===t),onClick:e=>e.stopPropagation(),className:"mt-0.5"}),(0,r.jsxs)("div",{className:"min-w-0",children:[(0,r.jsx)("label",{htmlFor:e.id,className:"cursor-pointer text-sm font-semibold",children:e.name}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})},e.id)})})]})}let v=["Project Info","Structure","Frameworks"];function b(e){let{onSubmit:t,isLoading:n}=e,[s,c]=(0,i.useState)(1),[d,u]=(0,i.useState)({}),[h,g]=(0,i.useState)(""),[x,y]=(0,i.useState)(""),[b,N]=(0,i.useState)(""),[k,w]=(0,i.useState)(""),[C,S]=(0,i.useState)([]);return(0,r.jsxs)("div",{className:"mx-auto w-full max-w-2xl space-y-6",children:[(0,r.jsx)(m,{currentStep:s,totalSteps:3,stepLabels:v}),(0,r.jsx)(a.Zb,{children:(0,r.jsxs)(a.aY,{className:"p-6",children:[1===s&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Project Information"}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsxs)("label",{htmlFor:"project-name",className:"text-sm font-medium",children:["Project Name ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"project-name",type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",placeholder:"My Application",value:h,onChange:e=>g(e.target.value)}),d.name&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:d.name})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsxs)("label",{htmlFor:"project-stack",className:"text-sm font-medium",children:["Tech Stack ",(0,r.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,r.jsx)("input",{id:"project-stack",type:"text",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring",placeholder:"Next.js, TypeScript, PostgreSQL",value:x,onChange:e=>y(e.target.value)}),d.stack&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:d.stack})]}),(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsx)("label",{htmlFor:"project-description",className:"text-sm font-medium",children:"Description"}),(0,r.jsx)(l,{id:"project-description",className:"min-h-[80px]",placeholder:"Brief description of the project...",value:b,onChange:e=>N(e.target.value)}),d.description&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:d.description})]})]}),2===s&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Project Structure"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Paste your project's directory structure below. This is used to analyze your codebase layout for compliance checks."}),(0,r.jsx)(f,{value:k,onChange:w}),d.structure&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:d.structure})]}),3===s&&(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold",children:"Select Frameworks"}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Choose one or more compliance frameworks to assess against."}),(0,r.jsx)(j,{selected:C,onChange:S}),d.frameworks&&(0,r.jsx)("p",{className:"text-xs text-red-500",children:d.frameworks})]})]})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)(o.z,{type:"button",variant:"outline",onClick:function(){u({}),c(e=>Math.max(e-1,1))},disabled:1===s||n,children:"Back"}),(0,r.jsx)("div",{className:"flex gap-2",children:s<3?(0,r.jsx)(o.z,{type:"button",onClick:function(){if(1===s){let e={};if(h.trim()||(e.name="Project name is required."),x.trim()||(e.stack="Tech stack is required."),Object.keys(e).length>0){u(e);return}}if(2===s&&!k.trim()){u({structure:"Project structure is required."});return}u({}),c(e=>Math.min(e+1,3))},disabled:n,children:"Next"}):(0,r.jsx)(o.z,{type:"button",onClick:function(){let e={name:h.trim(),description:b.trim(),stack:x.trim(),structure:k.trim(),frameworks:C},n=p.safeParse(e);if(!n.success){let e={};for(let t of n.error.issues){let n=t.path[0];"string"==typeof n&&(e[n]=t.message)}u(e),e.name||e.stack||e.description?c(1):e.structure?c(2):e.frameworks&&c(3);return}u({}),t(n.data)},disabled:n,children:n?"Running Assessment...":"Run Assessment"})})]})]})}function N(e){let t=e.split(".");return t.length<=1?"":t[t.length-1]}function k(e){let t=e.split("/");return t[t.length-1]}function w(e){let t=e.split("/");return t.length<=1?"":t.slice(0,-1).join("/")}function C(e,t,n){if(n.includes("*")){let r=RegExp("^"+n.replace(/\./g,"\\.").replace(/\*/g,".*")+"$");return r.test(e)||r.test(t)}return e===n||t===n}let S=[{pattern:"next",label:"Next.js"},{pattern:"react",label:"React"},{pattern:"vue",label:"Vue"},{pattern:"@angular/core",label:"Angular"},{pattern:"svelte",label:"Svelte"},{pattern:"express",label:"Express"},{pattern:"fastify",label:"Fastify"},{pattern:"koa",label:"Koa"},{pattern:"hapi",label:"Hapi"},{pattern:"@nestjs/core",label:"NestJS"},{pattern:"nuxt",label:"Nuxt"},{pattern:"remix",label:"Remix"},{pattern:"gatsby",label:"Gatsby"},{pattern:"astro",label:"Astro"},{pattern:"hono",label:"Hono"},{pattern:"elysia",label:"Elysia"}];function P(e,t,n){return Object.keys({...e,...t}).some(e=>e===n||e.startsWith("".concat(n,"/"))||e.startsWith("@".concat(n,"/")))}function I(e){return e.startsWith("^")||e.startsWith("~")||"*"===e||"latest"===e}function A(e){return e.projectStructure.files.some(e=>e.indicators.isApiRoute)}function E(e,t,n,r,s,i,o,a){return{id:e,title:t,description:n,category:"security",priority:"P0",frameworkRefs:o,fileRef:a,riskStatement:r,fixRecommendation:s,verificationMethod:i}}let R=[{id:"SEC-001",name:"Secrets Detection",description:"Check for hardcoded secrets or committed .env files",category:"security",priority:"P0",check(e){let{projectStructure:t}=e,n=t.files.some(e=>e.indicators.hasHardcodedSecrets),r=t.hasEnvFile&&!t.hasGitIgnore;return n||r?{passed:!1,finding:E("SEC-001","Potential Secrets Exposure","Hardcoded secrets detected or .env file present without .gitignore protection.","Secrets could be exposed in version control, leading to unauthorized access.","Remove hardcoded secrets, use environment variables, and ensure .gitignore includes .env files.","Search codebase for API keys, tokens, and passwords. Verify .gitignore entries.",[{frameworkId:"owasp-top10",controlId:"A01:2021",controlName:"Broken Access Control"},{frameworkId:"nist-ssdf",controlId:"PW.6.1",controlName:"Configure compilation and build processes to improve executable security"}])}:{passed:!0}}},{id:"SEC-002",name:"Authentication Missing",description:"Check if API routes lack authentication middleware",category:"security",priority:"P0",check:e=>A(e)?e.projectStructure.files.some(e=>e.indicators.hasAuthMiddleware)?{passed:!0}:{passed:!1,finding:E("SEC-002","Missing Authentication","API routes detected without authentication middleware.","Unauthenticated endpoints can be exploited to access or modify data without authorization.","Implement authentication middleware (JWT, OAuth, session-based) on all protected API routes.","Review API route files for authentication guards or middleware usage.",[{frameworkId:"owasp-top10",controlId:"A07:2021",controlName:"Identification and Authentication Failures"},{frameworkId:"owasp-asvs",controlId:"V2.1",controlName:"Authentication Verification Requirements"}])}:{passed:!0}},{id:"SEC-003",name:"Injection Risk",description:"Check for string concatenation in database queries",category:"security",priority:"P0",check:e=>e.projectStructure.files.some(e=>e.indicators.hasStringConcatQueries&&!e.indicators.hasParameterizedQueries)?{passed:!1,finding:E("SEC-003","SQL/NoSQL Injection Risk","String concatenation detected in database queries without parameterized query usage.","Injection vulnerabilities allow attackers to execute arbitrary database commands.","Replace string concatenation with parameterized queries or an ORM with built-in protection.","Search for string concatenation patterns near database query calls.",[{frameworkId:"owasp-top10",controlId:"A03:2021",controlName:"Injection"},{frameworkId:"owasp-asvs",controlId:"V5.3",controlName:"Output Encoding and Injection Prevention"}])}:{passed:!0}},{id:"SEC-004",name:"Input Validation Missing",description:"Check if API routes lack input validation",category:"security",priority:"P0",check:e=>A(e)?e.projectStructure.files.filter(e=>e.indicators.isApiRoute).some(e=>e.indicators.hasInputValidation)?{passed:!0}:{passed:!1,finding:E("SEC-004","Missing Input Validation","API routes detected without input validation.","Unvalidated input can lead to injection attacks, data corruption, and application crashes.","Add input validation using libraries like Zod, Joi, or class-validator on all API endpoints.","Check API route handlers for schema validation before processing request data.",[{frameworkId:"owasp-top10",controlId:"A03:2021",controlName:"Injection"},{frameworkId:"owasp-asvs",controlId:"V5.1",controlName:"Input Validation"}])}:{passed:!0}},{id:"SEC-005",name:"CORS Missing",description:"Check if API lacks CORS configuration",category:"security",priority:"P0",check:e=>A(e)?e.projectStructure.files.some(e=>e.indicators.hasCorsConfig)?{passed:!0}:{passed:!1,finding:E("SEC-005","Missing CORS Configuration","No CORS configuration detected for API routes.","Without CORS restrictions, the API may be vulnerable to cross-origin attacks.","Configure CORS middleware with specific allowed origins, methods, and headers.","Check for CORS middleware configuration in server setup or API route files.",[{frameworkId:"owasp-top10",controlId:"A05:2021",controlName:"Security Misconfiguration"}])}:{passed:!0}},{id:"SEC-006",name:"Rate Limiting Missing",description:"Check if API lacks rate limiting",category:"security",priority:"P0",check:e=>A(e)?e.projectStructure.files.some(e=>e.indicators.hasRateLimiting)?{passed:!0}:{passed:!1,finding:E("SEC-006","Missing Rate Limiting","No rate limiting detected on API routes.","Without rate limiting, the API is vulnerable to brute-force and denial-of-service attacks.","Implement rate limiting middleware (e.g., express-rate-limit, @fastify/rate-limit).","Check for rate limiting middleware in server or API route configuration.",[{frameworkId:"owasp-top10",controlId:"A04:2021",controlName:"Insecure Design"}])}:{passed:!0}},{id:"SEC-007",name:"Environment File Committed",description:"Check if .env file is in the project structure",category:"security",priority:"P0",check:e=>e.projectStructure.hasEnvFile?{passed:!1,finding:E("SEC-007","Environment File in Repository","A .env file was detected in the project structure, suggesting secrets may be committed to version control.","Committed .env files expose secrets such as API keys, database credentials, and tokens.","Remove .env from version control, add it to .gitignore, and use .env.example for documentation.","Check if .env is listed in .gitignore and verify it is not tracked in version control.",[{frameworkId:"owasp-top10",controlId:"A02:2021",controlName:"Cryptographic Failures"},{frameworkId:"soc2",controlId:"CC6.1",controlName:"Logical and Physical Access Controls"}],".env")}:{passed:!0}},{id:"SEC-008",name:"Debug Endpoints",description:"Check for debug or test endpoints in non-test files",category:"security",priority:"P0",check(e){let t=e.projectStructure.files.filter(e=>!e.indicators.isTestFile&&e.indicators.isApiRoute&&(e.name.includes("debug")||e.name.includes("test-")||e.path.includes("debug/")));return t.length>0?{passed:!1,finding:E("SEC-008","Debug Endpoints Detected","Debug or test endpoints found in non-test files that may be accessible in production.","Debug endpoints can leak sensitive information and provide attack vectors.","Remove debug endpoints or ensure they are disabled in production via environment flags.","Search for debug/test route handlers in production code.",[{frameworkId:"owasp-top10",controlId:"A05:2021",controlName:"Security Misconfiguration"}],t[0].path)}:{passed:!0}}}];function O(e,t,n,r,s,i,o){return{id:e,title:t,description:n,category:"quality",priority:"P1",frameworkRefs:o,riskStatement:r,fixRecommendation:s,verificationMethod:i}}let D=[{id:"QUA-001",name:"No Tests",description:"Check if the project has no test files",category:"quality",priority:"P1",check:e=>e.projectStructure.hasTests?{passed:!0}:{passed:!1,finding:O("QUA-001","No Test Files Detected","The project structure contains no test files (.test.*, .spec.*, __tests__/).","Without tests, there is no automated way to verify correctness, increasing regression risk.","Add unit and integration tests using Jest, Vitest, or a testing framework appropriate for your stack.","Search for files matching *.test.*, *.spec.*, or __tests__/ directories.",[{frameworkId:"nist-ssdf",controlId:"PW.8.2",controlName:"Test executable code to identify vulnerabilities"},{frameworkId:"soc2",controlId:"CC8.1",controlName:"Change Management"}])}},{id:"QUA-002",name:"No TypeScript Strict Mode",description:"Check if TypeScript is used without strict mode",category:"quality",priority:"P1",check(e){let{projectStructure:t}=e,n=t.files.some(e=>"ts"===e.extension||"tsx"===e.extension);return t.hasTsConfig&&!n?{passed:!1,finding:O("QUA-002","TypeScript Configuration Issue","tsconfig.json exists but no TypeScript files were detected, suggesting misconfiguration.","Misconfigured TypeScript setup may bypass type safety checks.","Ensure TypeScript strict mode is enabled in tsconfig.json and source files use .ts/.tsx extensions.",'Verify tsconfig.json has "strict": true and source files use TypeScript.',[{frameworkId:"nist-ssdf",controlId:"PW.6.2",controlName:"Review and/or analyze code to identify vulnerabilities"}])}:{passed:!0}}},{id:"QUA-003",name:"No Linting",description:"Check if no ESLint configuration exists",category:"quality",priority:"P1",check:e=>e.projectStructure.hasEslint?{passed:!0}:{passed:!1,finding:O("QUA-003","No Linting Configuration","No ESLint configuration file detected in the project.","Without linting, code quality issues and potential bugs go undetected during development.","Add ESLint with an appropriate config (e.g., eslint-config-next, @typescript-eslint).","Check for .eslintrc.*, eslint.config.js, or eslint configuration in package.json.",[{frameworkId:"nist-ssdf",controlId:"PW.7.2",controlName:"Review and/or analyze code to identify vulnerabilities"}])}},{id:"QUA-004",name:"No Error Handling",description:"Check if files lack try/catch error handling",category:"quality",priority:"P1",check(e){let t=e.projectStructure.files.filter(e=>!e.indicators.isTestFile&&!e.indicators.isConfigFile&&("ts"===e.extension||"tsx"===e.extension||"js"===e.extension||"jsx"===e.extension));return 0===t.length?{passed:!0}:t.some(e=>e.indicators.hasTryCatch)?{passed:!0}:{passed:!1,finding:O("QUA-004","No Error Handling Detected","No try/catch error handling patterns found in source files.","Unhandled errors can cause application crashes, data corruption, and poor user experience.","Add proper error handling with try/catch blocks, error boundaries, and global error handlers.","Search for try/catch blocks in source files and verify error boundary components.",[{frameworkId:"owasp-asvs",controlId:"V7.1",controlName:"Log Content"}])}}},{id:"QUA-005",name:"No Structured Logging",description:"Check if only console.log is used instead of structured logging",category:"quality",priority:"P1",check:e=>e.projectStructure.files.filter(e=>!e.indicators.isTestFile&&!e.indicators.isConfigFile&&("ts"===e.extension||"tsx"===e.extension||"js"===e.extension||"jsx"===e.extension)).some(e=>e.indicators.hasConsoleLog)&&!e.projectStructure.files.some(e=>e.name.includes("logger")||e.name.includes("logging")||e.path.includes("lib/logger")||e.path.includes("utils/logger"))?{passed:!1,finding:O("QUA-005","No Structured Logging","Only console.log usage detected without a structured logging solution.","Console.log is insufficient for production â€” logs lack structure, levels, and are hard to aggregate.","Implement structured logging using Winston, Pino, or a similar library with log levels and formatting.","Check for a logging library in dependencies and logger utility files.",[{frameworkId:"owasp-asvs",controlId:"V7.1",controlName:"Log Content"},{frameworkId:"soc2",controlId:"CC7.2",controlName:"System Monitoring"}])}:{passed:!0}},{id:"QUA-006",name:"Unpinned Dependencies",description:"Check for unpinned dependency versions",category:"quality",priority:"P1",check(e){let t=e.projectStructure.packageJson;return t&&t.hasUnpinnedDeps?{passed:!1,finding:O("QUA-006","Unpinned Dependencies","Some dependencies use version ranges (^, ~, *) instead of exact versions.","Unpinned dependencies can introduce breaking changes or vulnerabilities on install.","Pin all dependencies to exact versions and use a lock file (package-lock.json, yarn.lock).","Review package.json for ^, ~, or * prefixed versions.",[{frameworkId:"nist-ssdf",controlId:"PS.3.1",controlName:"Maintain provenance data for all components of each software release"},{frameworkId:"owasp-top10",controlId:"A06:2021",controlName:"Vulnerable and Outdated Components"}])}:{passed:!0}}},{id:"QUA-007",name:"API Contract Missing",description:"Check if API routes exist without OpenAPI/Swagger documentation",category:"quality",priority:"P1",check:e=>e.projectStructure.files.some(e=>e.indicators.isApiRoute)?e.projectStructure.hasApiDocs?{passed:!0}:{passed:!1,finding:O("QUA-007","Missing API Contract Documentation","API routes exist but no OpenAPI/Swagger documentation was found.","Without an API contract, consumers face integration issues and there is no single source of truth.","Add an OpenAPI/Swagger specification file and consider auto-generating it from route definitions.","Check for openapi.yaml, swagger.json, or API documentation files in the project.",[{frameworkId:"nist-ssdf",controlId:"PW.4.4",controlName:"Document the design"}])}:{passed:!0}}];function T(e,t,n,r,s,i,o){return{id:e,title:t,description:n,category:"operations",priority:"P2",frameworkRefs:o,riskStatement:r,fixRecommendation:s,verificationMethod:i}}let M=[{id:"OPS-001",name:"No CI/CD Pipeline",description:"Check if no CI/CD configuration exists",category:"operations",priority:"P2",check:e=>e.projectStructure.hasCiConfig?{passed:!0}:{passed:!1,finding:T("OPS-001","No CI/CD Pipeline","No CI/CD configuration detected (GitHub Actions, GitLab CI, Jenkins, etc.).","Without CI/CD, builds, tests, and deployments are manual, error-prone, and inconsistent.","Set up a CI/CD pipeline with automated build, test, lint, and deployment stages.","Check for .github/workflows/, .gitlab-ci.yml, Jenkinsfile, or similar CI config files.",[{frameworkId:"nist-ssdf",controlId:"PO.3.2",controlName:"Implement and maintain secure environments for software development"},{frameworkId:"soc2",controlId:"CC8.1",controlName:"Change Management"}])}},{id:"OPS-002",name:"No Environment Configuration Template",description:"Check if no .env.example file exists",category:"operations",priority:"P2",check:e=>e.projectStructure.hasEnvExample?{passed:!0}:{passed:!1,finding:T("OPS-002","No Environment Configuration Template","No .env.example or .env.sample file found to document required environment variables.","New developers and deployment pipelines have no reference for required configuration.","Create a .env.example file listing all required environment variables with placeholder values.","Check for .env.example or .env.sample file in the project root.",[{frameworkId:"nist-ssdf",controlId:"PO.3.2",controlName:"Implement and maintain secure environments for software development"}])}},{id:"OPS-003",name:"No Health Checks",description:"Check if no health check endpoint patterns are found",category:"operations",priority:"P2",check:e=>e.projectStructure.files.some(e=>e.name.includes("health")||e.path.includes("api/health")||e.path.includes("routes/health")||e.name.includes("readiness")||e.name.includes("liveness"))?{passed:!0}:{passed:!1,finding:T("OPS-003","No Health Check Endpoints","No health check, readiness, or liveness endpoint patterns detected.","Without health checks, load balancers and orchestrators cannot verify application availability.","Add /health, /ready, and /live endpoints that report application and dependency status.","Search for health, readiness, or liveness route handlers in the project.",[{frameworkId:"soc2",controlId:"CC7.1",controlName:"System Availability Monitoring"}])}},{id:"OPS-004",name:"No Docker Configuration",description:"Check if no Dockerfile exists",category:"operations",priority:"P2",check:e=>e.projectStructure.hasDockerfile?{passed:!0}:{passed:!1,finding:T("OPS-004","No Docker Configuration","No Dockerfile or docker-compose configuration detected.","Without containerization, deployments may be inconsistent across environments.","Add a Dockerfile with a multi-stage build and consider docker-compose for local development.","Check for Dockerfile, docker-compose.yml, or docker-compose.yaml in the project.",[{frameworkId:"nist-ssdf",controlId:"PO.3.1",controlName:"Specify tools and tool configuration"}])}},{id:"OPS-005",name:"No Monitoring Setup",description:"Check for absence of monitoring/observability configuration",category:"operations",priority:"P2",check:e=>e.projectStructure.files.some(e=>e.name.includes("sentry")||e.name.includes("datadog")||e.name.includes("newrelic")||e.name.includes("prometheus")||e.name.includes("grafana")||e.name.includes("monitoring")||e.name.includes("observability")||e.name.includes("tracing")||e.name.includes("instrumentation")||e.path.includes("monitoring/")||e.path.includes("observability/"))?{passed:!0}:{passed:!1,finding:T("OPS-005","No Monitoring or Observability Setup","No monitoring, tracing, or observability configuration detected.","Without monitoring, production issues go undetected until users report them.","Integrate an observability tool (Sentry, Datadog, New Relic, Prometheus/Grafana, OpenTelemetry).","Check for monitoring library configuration files and dependencies.",[{frameworkId:"soc2",controlId:"CC7.2",controlName:"System Monitoring"}])}}];function L(e,t,n,r,s,i,o){return{id:e,title:t,description:n,category:"governance",priority:"P3",frameworkRefs:o,riskStatement:r,fixRecommendation:s,verificationMethod:i}}let F=[{id:"GOV-001",name:"No README",description:"Check if the project has a README file",category:"governance",priority:"P3",check:e=>e.projectStructure.hasReadme?{passed:!0}:{passed:!1,finding:L("GOV-001","No README File","No README file detected in the project root.","Without a README, new developers cannot understand the project purpose, setup, or usage.","Create a README.md with project description, setup instructions, usage examples, and contribution guidelines.","Check for README.md, README.rst, or README file in the project root.",[{frameworkId:"nist-ssdf",controlId:"PW.4.4",controlName:"Document the design"}])}},{id:"GOV-002",name:"No API Documentation",description:"Check if the project has API documentation",category:"governance",priority:"P3",check:e=>e.projectStructure.hasApiDocs?{passed:!0}:{passed:!1,finding:L("GOV-002","No API Documentation","No OpenAPI/Swagger or API documentation files detected.","Without API documentation, consumers cannot integrate correctly, increasing support burden.","Create OpenAPI/Swagger documentation for all public API endpoints.","Check for openapi.yaml, swagger.json, or files in docs/api/ directories.",[{frameworkId:"nist-ssdf",controlId:"PW.4.4",controlName:"Document the design"}])}},{id:"GOV-003",name:"No Architecture Decision Records",description:"Check if the project has ADRs",category:"governance",priority:"P3",check:e=>e.projectStructure.hasAdr?{passed:!0}:{passed:!1,finding:L("GOV-003","No Architecture Decision Records","No ADR (Architecture Decision Record) files or directory detected.","Without ADRs, architectural decisions lack context and rationale for future maintainers.","Create a docs/adr/ directory and document key architectural decisions using the ADR template.","Check for docs/adr/, docs/architecture-decisions/, or ADR files in the project.",[{frameworkId:"nist-ssdf",controlId:"PO.1.1",controlName:"Create and maintain a secure software development policy"}])}},{id:"GOV-004",name:"No CHANGELOG",description:"Check if the project has a CHANGELOG",category:"governance",priority:"P3",check:e=>e.projectStructure.hasChangelog?{passed:!0}:{passed:!1,finding:L("GOV-004","No CHANGELOG","No CHANGELOG file detected in the project.","Without a changelog, it is difficult to track what changed between releases.","Create a CHANGELOG.md following the Keep a Changelog format and update it with each release.","Check for CHANGELOG.md or CHANGELOG file in the project root.",[{frameworkId:"nist-ssdf",controlId:"PS.3.2",controlName:"Make software integrity verification information available"}])}},{id:"GOV-005",name:"No LICENSE",description:"Check if the project has a LICENSE file",category:"governance",priority:"P3",check:e=>e.projectStructure.hasLicense?{passed:!0}:{passed:!1,finding:L("GOV-005","No LICENSE File","No LICENSE file detected in the project.","Without a license, the legal terms for using and distributing the software are unclear.","Add a LICENSE file with the appropriate open-source or proprietary license.","Check for LICENSE, LICENSE.md, or LICENSE.txt in the project root.",[{frameworkId:"nist-ssdf",controlId:"PS.1.1",controlName:"Protect all forms of code from unauthorized access"}])}},{id:"GOV-006",name:"No SBOM",description:"Check if the project has a Software Bill of Materials",category:"governance",priority:"P3",check:e=>e.projectStructure.hasSbom?{passed:!0}:{passed:!1,finding:L("GOV-006","No Software Bill of Materials (SBOM)","No SBOM file detected (CycloneDX, SPDX, or similar).","Without an SBOM, there is no inventory of components, making vulnerability tracking difficult.","Generate an SBOM using CycloneDX or SPDX tools and include it in CI/CD pipeline artifacts.","Check for sbom.json, bom.json, bom.xml, or CycloneDX/SPDX files.",[{frameworkId:"nist-ssdf",controlId:"PS.3.1",controlName:"Maintain provenance data for all components of each software release"},{frameworkId:"owasp-top10",controlId:"A06:2021",controlName:"Vulnerable and Outdated Components"}])}},{id:"GOV-007",name:"No CODEOWNERS",description:"Check if the project has a CODEOWNERS file",category:"governance",priority:"P3",check:e=>e.projectStructure.hasCodeowners?{passed:!0}:{passed:!1,finding:L("GOV-007","No CODEOWNERS File","No CODEOWNERS file detected in the project.","Without CODEOWNERS, code review assignments are unclear and critical paths may lack review.","Create a CODEOWNERS file mapping directories and files to responsible team members.","Check for CODEOWNERS in the project root, .github/, or docs/ directory.",[{frameworkId:"soc2",controlId:"CC8.1",controlName:"Change Management"}])}},{id:"GOV-008",name:"No SECURITY.md",description:"Check if the project has a security policy",category:"governance",priority:"P3",check:e=>e.projectStructure.hasSecurityMd?{passed:!0}:{passed:!1,finding:L("GOV-008","No Security Policy","No SECURITY.md file detected in the project.","Without a security policy, vulnerability reporters have no guidance on responsible disclosure.","Create a SECURITY.md documenting the vulnerability reporting process and supported versions.","Check for SECURITY.md in the project root or .github/ directory.",[{frameworkId:"nist-ssdf",controlId:"RV.1.1",controlName:"Identify and confirm vulnerabilities on an ongoing basis"}])}},{id:"GOV-009",name:"No CONTRIBUTING Guide",description:"Check if the project has contribution guidelines",category:"governance",priority:"P3",check:e=>e.projectStructure.hasContributing?{passed:!0}:{passed:!1,finding:L("GOV-009","No Contribution Guidelines","No CONTRIBUTING.md file detected in the project.","Without contribution guidelines, external and new contributors lack onboarding guidance.","Create a CONTRIBUTING.md with coding standards, PR process, and development setup instructions.","Check for CONTRIBUTING.md in the project root or .github/ directory.",[{frameworkId:"nist-ssdf",controlId:"PO.2.1",controlName:"Implement roles and responsibilities"}])}}];var U=n(4172);let W=[{antiPatternId:"it-compiles-fallacy",detect(e){let{projectStructure:t}=e,n=t.files.some(e=>!e.indicators.isTestFile&&!e.indicators.isConfigFile&&("ts"===e.extension||"tsx"===e.extension||"js"===e.extension||"jsx"===e.extension)),r=!t.hasTests,s=!t.files.some(e=>e.indicators.hasInputValidation),i=!t.files.some(e=>e.indicators.hasTryCatch);return n&&r&&s&&i}},{antiPatternId:"secret-soup",detect(e){let{projectStructure:t}=e,n=t.hasEnvFile&&!t.hasGitIgnore,r=t.files.some(e=>e.indicators.hasHardcodedSecrets);return n||r}},{antiPatternId:"the-open-door",detect(e){let t=e.projectStructure.files.some(e=>e.indicators.isApiRoute),n=e.projectStructure.files.some(e=>e.indicators.hasAuthMiddleware);return t&&!n}},{antiPatternId:"string-query-roulette",detect:e=>e.projectStructure.files.some(e=>e.indicators.hasStringConcatQueries)},{antiPatternId:"the-silent-failure",detect(e){let{projectStructure:t}=e,n=t.files.some(e=>e.indicators.hasTryCatch),r=t.files.some(e=>e.indicators.hasConsoleLog)&&!t.files.some(e=>e.name.includes("logger")||e.name.includes("logging")||e.path.includes("lib/logger"));return n&&r}},{antiPatternId:"dependency-roulette",detect(e){var t,n;let{projectStructure:r}=e,s=null!==(n=null===(t=r.packageJson)||void 0===t?void 0:t.hasUnpinnedDeps)&&void 0!==n&&n,i=!r.hasLockFile;return s||i}},{antiPatternId:"the-god-component",detect:e=>e.projectStructure.files.some(e=>e.indicators.isComponent&&e.indicators.lineCount>500)},{antiPatternId:"config-chaos",detect(e){let{projectStructure:t}=e;return t.hasEnvFile||!t.hasEnvExample}},{antiPatternId:"the-phantom-endpoint",detect:e=>e.projectStructure.files.some(e=>!e.indicators.isTestFile&&e.indicators.isApiRoute&&(e.name.includes("debug")||e.name.includes("test-")||e.path.includes("debug/")))},{antiPatternId:"documentation-desert",detect(e){let{projectStructure:t}=e;return!t.hasReadme&&!t.hasApiDocs&&!t.hasAdr}}],G={security:8,quality:7,operations:5,governance:9},q=G.security+G.quality+G.operations+G.governance;function V(e){return Math.max(0,Math.min(100,Math.round(e)))}function z(e,t){let n=G[t];return 0===n?100:V((n-e.filter(e=>e.category===t).length)/n*100)}function B(e,t){let n=function(e,t){let n=new Set;for(let r of e)for(let e of r.frameworkRefs)e.frameworkId===t&&n.add(e.controlId);return n}(e,t),r={"owasp-top10":10,"nist-ssdf":12,soc2:6,"owasp-asvs":8}[t],s=n.size,i=Math.max(0,r-s);return{frameworkId:t,score:V(r>0?i/r*100:100),totalControls:r,passingControls:i,failingControls:s}}let Q={P0:0,P1:1,P2:2,P3:3},H={P0:"Immediate",P1:"Sprint 1",P2:"Sprint 2",P3:"Sprint 3"};function $(e){return{...e,status:"pending",slaTarget:H[e.priority]}}var _=n(8854);function Z(){let e=(0,s.useRouter)(),[t,n]=(0,i.useState)(!1),[o,a]=(0,i.useState)(null);return t?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary"}),(0,r.jsx)("p",{className:"text-lg text-muted-foreground",children:"Running compliance audit..."}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"Analyzing your project against SDLC standards"})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"New Compliance Assessment"}),o&&(0,r.jsxs)("div",{className:"rounded-md bg-destructive/15 p-4 text-destructive",children:[(0,r.jsx)("p",{className:"font-medium",children:"Assessment failed"}),(0,r.jsx)("p",{className:"text-sm mt-1",children:o})]}),(0,r.jsx)(b,{onSubmit:t=>{n(!0),a(null);try{let n=function(e){let t=performance.now(),n=function(e){let t=function(e){let t=e.split("\n"),n=[],r=new Set;for(let e of t){if(!function(e){let t=e.trim();if(""===t||t.startsWith("#"))return!1;let n=t.replace(/[\u2502\u251C\u2514\u2500\u252C\u2524\u250C\u2510\u2518\u253C\s|+\\-]/g,"");return""!==n&&(n.includes(".")||n.includes("/"))}(e))continue;let t=e.replace(/[\u2502\u251C\u2514\u2500\u252C\u2524\u250C\u2510\u2518\u253C|+\\]/g,"").replace(/^\s+/,"").replace(/\s+$/,"").replace(/^\/+/,"");if(""===t)continue;let s=k(t),i=w(t),o=N(t);i&&r.add(i);let a=function(e,t){let n=N(e),r=w(e),s=t.includes(".test.")||t.includes(".spec.")||r.includes("__tests__")||r.includes("test/")||r.includes("tests/"),i=e.includes("api/")||e.includes("routes/")||e.includes("controllers/")||e.includes("handlers/"),o=("tsx"===n||"jsx"===n)&&!s&&(r.includes("components")||r.includes("pages")||r.includes("app")),a=t.startsWith(".")||t.endsWith(".config.js")||t.endsWith(".config.ts")||t.endsWith(".config.mjs")||"package.json"===t||"tsconfig.json"===t;return{hasHardcodedSecrets:!1,hasConsoleLog:!1,hasTryCatch:!1,hasInputValidation:!1,hasAuthMiddleware:t.includes("auth")||t.includes("middleware")||r.includes("middleware"),hasRateLimiting:t.includes("rate-limit")||t.includes("rateLimit"),hasCorsConfig:t.includes("cors"),hasParameterizedQueries:!1,hasStringConcatQueries:!1,hasTestImports:s,lineCount:0,isComponent:o,isApiRoute:i,isTestFile:s,isConfigFile:a}}(t,s);n.push({path:t,name:s,extension:o,directory:i,indicators:a})}let s=n.map(e=>e.name),i=n.map(e=>e.path),o=s.includes("package.json"),a=s.includes("package-lock.json")||s.includes("yarn.lock")||s.includes("pnpm-lock.yaml")||s.includes("bun.lockb"),c=s.some(e=>e.startsWith("tsconfig")),l=s.some(e=>e.startsWith(".eslintrc")||"eslint.config.js"===e||"eslint.config.mjs"===e),d=s.some(e=>e.startsWith(".prettierrc")||"prettier.config.js"===e),u=s.includes(".gitignore"),p=s.includes(".env"),m=s.includes(".env.example")||s.includes(".env.sample"),f=s.some(e=>"Dockerfile"===e||e.startsWith("docker-compose")),h=i.some(e=>e.includes(".github/workflows/")||e.includes(".gitlab-ci")||e.includes("Jenkinsfile")||e.includes(".circleci")||e.includes("bitbucket-pipelines")),g=n.some(e=>e.indicators.isTestFile),x=s.some(e=>e.toUpperCase().startsWith("README")),y=s.some(e=>e.toUpperCase().startsWith("CHANGELOG")),j=s.some(e=>"LICENSE"===e.toUpperCase()||"LICENSE.MD"===e.toUpperCase()),v=s.some(e=>"CODEOWNERS"===e.toUpperCase()),b=s.some(e=>e.includes("sbom")||e.includes("bom.json")||e.includes("bom.xml")||"cyclonedx.json"===e),S=s.some(e=>"SECURITY.MD"===e.toUpperCase()||"SECURITY"===e.toUpperCase()),P=s.some(e=>"CONTRIBUTING.MD"===e.toUpperCase()||"CONTRIBUTING"===e.toUpperCase()),I=i.some(e=>e.includes("swagger")||e.includes("openapi")||e.includes("api-docs")||C(k(e),e,"openapi.*")||C(k(e),e,"swagger.*")),A=i.some(e=>e.toLowerCase().includes("adr/")||e.toLowerCase().includes("docs/adr")||e.toLowerCase().includes("architecture-decisions"));return{files:n,directories:Array.from(r),hasPackageJson:o,hasLockFile:a,hasTsConfig:c,hasEslint:l,hasPrettier:d,hasGitIgnore:u,hasEnvExample:m,hasEnvFile:p,hasDockerfile:f,hasCiConfig:h,hasTests:g,hasReadme:x,hasChangelog:y,hasLicense:j,hasCodeowners:v,hasSbom:b,hasSecurityMd:S,hasContributing:P,hasApiDocs:I,hasAdr:A}}(e.structure),n=function(e){let t=e.split("\n"),n=!1,r=0,s=[];for(let e of t){if("// package.json"===e.trim()||"# package.json"===e.trim()){n=!0;continue}if(n){for(let t of(s.push(e),e))"{"===t&&r++,"}"===t&&r--;if(r<=0&&s.length>0)break}}if(s.length>0)return s.join("\n")}(e.structure);return n&&(t.packageJson=function(e){var t;let n;try{n=JSON.parse(e)}catch(e){return{hasTypeScript:!1,hasEslint:!1,hasPrettier:!1,hasJest:!1,hasTestScript:!1,hasLintScript:!1,hasBuildScript:!1,dependencyCount:0,devDependencyCount:0,hasUnpinnedDeps:!1,frameworks:[]}}let r=n.dependencies,s=n.devDependencies,i=null!==(t=n.scripts)&&void 0!==t?t:{},o=P(r,s,"typescript"),a=P(r,s,"eslint"),c=P(r,s,"prettier"),l=P(r,s,"jest")||P(r,s,"vitest"),d="test"in i&&void 0!==i.test&&!i.test.includes("no test specified"),u=r?Object.keys(r).length:0,p=s?Object.keys(s).length:0,m=[...Object.values(null!=r?r:{}),...Object.values(null!=s?s:{})].some(I);return{hasTypeScript:o,hasEslint:a,hasPrettier:c,hasJest:l,hasTestScript:d,hasLintScript:"lint"in i,hasBuildScript:"build"in i,dependencyCount:u,devDependencyCount:p,hasUnpinnedDeps:m,frameworks:function(e,t){let n=Object.keys({...e,...t}),r=new Set;for(let e of S)n.some(t=>t===e.pattern||t.includes(e.pattern))&&r.add(e.label);return Array.from(r)}(r,s)}}(n)),{projectStructure:t,projectInput:{name:e.name,description:e.description,stack:e.stack,structure:e.structure}}}(e),r=[...R,...D,...M,...F],{findings:s,passed:i,failed:o}=function(e,t){let n=[],r=0,s=0;for(let i of e){let e=i.check(t);e.passed?r++:(s++,e.finding&&n.push(e.finding))}return{findings:n,passed:r,failed:s}}(r,n),a=function(e){let t=new Set,n=[];for(let r of e){let e=r.antiPatternId?"ap:".concat(r.antiPatternId):"check:".concat(r.id);t.has(e)||(t.add(e),n.push(r))}return n}([...s,...function(e){let t=[];for(let n of W)if(n.detect(e)){let e=function(e){return U.J.find(t=>t.id===e)}(n.antiPatternId);e&&t.push({id:"AP-".concat(String(e.number).padStart(3,"0")),title:"Anti-Pattern: ".concat(e.name),description:e.description,category:"security",priority:e.priority,frameworkRefs:e.frameworkRefs.map(e=>({frameworkId:e.frameworkId,controlId:e.controlId,controlName:e.controlId})),riskStatement:e.riskStatement,fixRecommendation:e.fixGuidance,verificationMethod:"Check for: ".concat(e.detectionPatterns.join(", ")),antiPatternId:e.id})}return t}(n)]),c=performance.now();return{findings:a,checksRun:r.length,checksPassed:i,checksFailed:o,duration:Math.round(c-t)}}(t),r=function(e,t){let n=V((q-e.length)/q*100),r=z(e,"security"),s=z(e,"quality"),i=z(e,"operations"),o=z(e,"governance"),a={"owasp-top10":B(e,"owasp-top10"),"nist-ssdf":B(e,"nist-ssdf"),soc2:B(e,"soc2"),"owasp-asvs":B(e,"owasp-asvs")};for(let e of Object.keys(a))t.includes(e)||(a[e]={frameworkId:e,score:0,totalControls:0,passingControls:0,failingControls:0});return{overall:n,security:r,quality:s,operations:i,governance:o,frameworkScores:a}}(n.findings,t.frameworks),s=function(e){let t=e.map($);return t.sort((e,t)=>{var n,r;let s=Q[e.priority]-Q[t.priority];if(0!==s)return s;let i={security:0,quality:1,operations:2,governance:3},o=(null!==(n=i[e.category])&&void 0!==n?n:4)-(null!==(r=i[t.category])&&void 0!==r?r:4);return 0!==o?o:e.id.localeCompare(t.id)}),t}(n.findings),i=new Date().toISOString(),o={id:(0,_.Ox)(),projectName:t.name,createdAt:i,updatedAt:i,status:"completed",input:t,findings:n.findings,scores:r,remediationPlan:s};(0,_.Re)(o),e.push("/assess/?id=".concat(o.id))}catch(e){console.error("Assessment failed:",e),a(e instanceof Error?e.message:"An unexpected error occurred"),n(!1)}},isLoading:t})]})}var Y=n(7648),J=n(7168),X=n(7204),K=n(5503);let ee={"owasp-top10":"OWASP Top 10","nist-ssdf":"NIST SSDF",soc2:"SOC 2","owasp-asvs":"OWASP ASVS"};function et(e){return e>=80?"[&>div]:bg-green-500":e>=50?"[&>div]:bg-yellow-500":"[&>div]:bg-red-500"}function en(e){return e>=80?"text-green-600":e>=50?"text-yellow-600":"text-red-600"}function er(e){let{scores:t}=e,n=[{key:"security",label:"Security",score:t.security},{key:"quality",label:"Quality",score:t.quality},{key:"operations",label:"Operations",score:t.operations},{key:"governance",label:"Governance",score:t.governance}],s=Object.entries(t.frameworkScores).filter(e=>{let[,t]=e;return t.totalControls>0});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("div",{className:"flex justify-center",children:(0,r.jsx)(K.c,{score:t.overall,label:"Overall Compliance"})}),(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{children:(0,r.jsx)(a.ll,{className:"text-lg",children:"Category Scores"})}),(0,r.jsx)(a.aY,{className:"space-y-4",children:n.map(e=>(0,r.jsxs)("div",{className:"space-y-1.5",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,r.jsx)("span",{className:"font-medium",children:e.label}),(0,r.jsxs)("span",{className:(0,c.cn)("font-semibold tabular-nums",en(e.score)),children:[e.score,"%"]})]}),(0,r.jsx)(X.E,{value:e.score,className:(0,c.cn)("h-2.5",et(e.score))})]},e.key))})]}),s.length>0&&(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{children:(0,r.jsx)(a.ll,{className:"text-lg",children:"Framework Scores"})}),(0,r.jsx)(a.aY,{children:(0,r.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:s.map(e=>{var t;let[n,s]=e;return(0,r.jsxs)("div",{className:"rounded-md border p-4 space-y-2",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("span",{className:"text-sm font-medium",children:null!==(t=ee[n])&&void 0!==t?t:n}),(0,r.jsxs)("span",{className:(0,c.cn)("text-sm font-semibold tabular-nums",en(s.score)),children:[s.score,"%"]})]}),(0,r.jsx)(X.E,{value:s.score,className:(0,c.cn)("h-2",et(s.score))}),(0,r.jsxs)("p",{className:"text-xs text-muted-foreground",children:[s.passingControls,"/",s.totalControls," controls passing"]})]},n)})})})]})]})}var es=n(1382),ei=n(9174);let eo={"owasp-top10":"OWASP Top 10","nist-ssdf":"NIST SSDF",soc2:"SOC 2","owasp-asvs":"OWASP ASVS"};function ea(e){let{frameworkId:t,className:n}=e,s=eo[t];return(0,r.jsx)(ei.C,{variant:"outline",className:(0,c.cn)(n),children:s})}function ec(e){let{finding:t}=e;return(0,r.jsx)(a.Zb,{children:(0,r.jsxs)(a.aY,{className:"p-4 space-y-3",children:[(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsx)("h4",{className:"font-semibold text-sm leading-tight",children:t.title}),(0,r.jsx)(es.U,{priority:t.priority})]}),(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:t.description}),t.fileRef&&(0,r.jsxs)("p",{className:"text-xs font-mono text-muted-foreground",children:[t.fileRef,t.lineRef?":".concat(t.lineRef):""]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-red-600",children:"Risk"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:t.riskStatement})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-green-600",children:"Recommended Fix"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:t.fixRecommendation})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("p",{className:"text-xs font-medium",children:"Verification"}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:t.verificationMethod})]}),t.frameworkRefs.length>0&&(0,r.jsx)("div",{className:"flex flex-wrap gap-1.5",children:t.frameworkRefs.map((e,t)=>(0,r.jsx)(ea,{frameworkId:e.frameworkId},t))})]})})}var el=n(9801);function ed(e){let{icon:t,title:n,description:s,action:i}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-16 px-4 text-center",children:[(0,r.jsx)("div",{className:"mb-4 text-muted-foreground",children:null!=t?t:(0,r.jsx)(el.Z,{className:"h-12 w-12"})}),(0,r.jsx)("h3",{className:"text-lg font-semibold tracking-tight",children:n}),(0,r.jsx)("p",{className:"mt-1 max-w-sm text-sm text-muted-foreground",children:s}),i&&(0,r.jsx)("div",{className:"mt-6",children:i})]})}let eu=["P0","P1","P2","P3"],ep=["security","quality","operations","governance"],em={P0:"P0 Critical",P1:"P1 High",P2:"P2 Medium",P3:"P3 Low"},ef={security:"Security",quality:"Quality",operations:"Operations",governance:"Governance"};function eh(e){let{findings:t}=e,[n,s]=(0,i.useState)("all"),[o,a]=(0,i.useState)("all"),c=t.filter(e=>("all"===n||e.priority===n)&&("all"===o||e.category===o));return 0===t.length?(0,r.jsx)(ed,{title:"No Findings",description:"No compliance issues were detected in this assessment."}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Priority"}),(0,r.jsxs)("select",{value:n,onChange:e=>s(e.target.value),className:"flex h-9 rounded-md border border-input bg-background px-3 py-1 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"All Priorities"}),eu.map(e=>(0,r.jsx)("option",{value:e,children:em[e]},e))]})]}),(0,r.jsxs)("div",{className:"space-y-1",children:[(0,r.jsx)("label",{className:"text-xs font-medium text-muted-foreground",children:"Category"}),(0,r.jsxs)("select",{value:o,onChange:e=>a(e.target.value),className:"flex h-9 rounded-md border border-input bg-background px-3 py-1 text-sm",children:[(0,r.jsx)("option",{value:"all",children:"All Categories"}),ep.map(e=>(0,r.jsx)("option",{value:e,children:ef[e]},e))]})]}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsxs)("span",{className:"text-sm text-muted-foreground",children:[c.length," of ",t.length," findings"]})})]}),(0,r.jsx)("div",{className:"space-y-3",children:c.map(e=>(0,r.jsx)(ec,{finding:e},e.id))})]})}function eg(e){let{findings:t}=e;return 0===t.length?(0,r.jsx)(ed,{title:"No Anti-Patterns Detected",description:"No vibe-code anti-patterns were found in this assessment."}):(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("p",{className:"text-sm text-muted-foreground",children:[t.length," vibe-code anti-pattern",1!==t.length?"s":""," detected"]}),(0,r.jsx)("div",{className:"space-y-3",children:t.map(e=>(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{className:"pb-3",children:(0,r.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,r.jsxs)(a.ll,{className:"text-base",children:[e.antiPatternId?"".concat(e.antiPatternId,": "):"",e.title]}),(0,r.jsx)(es.U,{priority:e.priority})]})}),(0,r.jsxs)(a.aY,{className:"space-y-3",children:[(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:e.description}),(0,r.jsxs)("div",{className:"rounded-md bg-red-50 p-3 dark:bg-red-950/20",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-red-700 dark:text-red-400",children:"Risk"}),(0,r.jsx)("p",{className:"text-xs text-red-600 dark:text-red-300 mt-1",children:e.riskStatement})]}),(0,r.jsxs)("div",{className:"rounded-md bg-green-50 p-3 dark:bg-green-950/20",children:[(0,r.jsx)("p",{className:"text-xs font-medium text-green-700 dark:text-green-400",children:"Recommended Fix"}),(0,r.jsx)("p",{className:"text-xs text-green-600 dark:text-green-300 mt-1",children:e.fixRecommendation})]})]})]},e.id))})]})}function ex(e){var t;let{id:n}=e,[s,a]=(0,i.useState)(null),[c,l]=(0,i.useState)(!0),[d,u]=(0,i.useState)(!1);if((0,i.useEffect)(()=>{try{let e=(0,_.AZ)(n);e?a(e):u(!0)}catch(e){console.error("Failed to load assessment:",e),u(!0)}finally{l(!1)}},[n]),c)return(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsx)("p",{className:"text-muted-foreground text-lg",children:"Loading assessment..."})});if(d||!s)return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-destructive",children:"Assessment Not Found"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:['The assessment with ID "',n,'" could not be found.']}),(0,r.jsx)(Y.default,{href:"/",children:(0,r.jsx)(o.z,{variant:"outline",children:"Back to Dashboard"})})]});let p=null!==(t=s.findings)&&void 0!==t?t:[],m=p.filter(e=>void 0!==e.antiPatternId&&null!==e.antiPatternId);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:s.projectName}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)(Y.default,{href:"/assess/?id=".concat(n,"&view=remediate"),children:(0,r.jsx)(o.z,{variant:"outline",children:"Remediation Plan"})}),(0,r.jsx)(Y.default,{href:"/assess/?id=".concat(n,"&view=export"),children:(0,r.jsx)(o.z,{children:"Export Report"})})]})]}),(0,r.jsxs)(J.mQ,{defaultValue:"scorecard",className:"w-full",children:[(0,r.jsxs)(J.dr,{children:[(0,r.jsx)(J.SP,{value:"scorecard",children:"Scorecard"}),(0,r.jsx)(J.SP,{value:"findings",children:"Findings"}),(0,r.jsx)(J.SP,{value:"anti-patterns",children:"Anti-Patterns"})]}),(0,r.jsx)(J.nU,{value:"scorecard",className:"mt-6",children:(0,r.jsx)(er,{scores:s.scores})}),(0,r.jsx)(J.nU,{value:"findings",className:"mt-6",children:(0,r.jsx)(eh,{findings:p})}),(0,r.jsx)(J.nU,{value:"anti-patterns",className:"mt-6",children:(0,r.jsx)(eg,{findings:m})})]})]})}let ey={P0:0,P1:1,P2:2,P3:3},ej={P0:"P0 Critical â€” Immediate",P1:"P1 High â€” Sprint 1",P2:"P2 Medium â€” Sprint 2",P3:"P3 Low â€” Sprint 3"},ev=["pending","in-progress","completed","skipped"];function eb(e){let{items:t,onStatusChange:n}=e,s=t.reduce((e,t)=>(e[t.priority]||(e[t.priority]=[]),e[t.priority].push(t),e),{}),i=Object.keys(s).sort((e,t)=>ey[e]-ey[t]),o=t.filter(e=>"completed"===e.status).length,l=t.length;return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm text-muted-foreground",children:[(0,r.jsxs)("span",{children:[o," of ",l," items completed"]}),(0,r.jsx)("div",{className:"flex-1 h-2 bg-secondary rounded-full overflow-hidden",children:(0,r.jsx)("div",{className:"h-full bg-green-500 transition-all",style:{width:"".concat(l>0?o/l*100:0,"%")}})})]}),i.map(e=>(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{className:"pb-3",children:(0,r.jsxs)(a.ll,{className:"text-base",children:[ej[e],(0,r.jsxs)("span",{className:"ml-2 text-sm font-normal text-muted-foreground",children:["(",s[e].length," items)"]})]})}),(0,r.jsx)(a.aY,{children:(0,r.jsx)("div",{className:"divide-y",children:s[e].map(e=>(0,r.jsxs)("div",{className:(0,c.cn)("flex items-start gap-4 py-3","completed"===e.status&&"opacity-60"),children:[(0,r.jsxs)("div",{className:"flex-1 min-w-0 space-y-1",children:[(0,r.jsx)("p",{className:(0,c.cn)("text-sm font-medium","completed"===e.status&&"line-through"),children:e.title}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:e.fixRecommendation}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)(es.U,{priority:e.priority,className:"text-[10px] px-1.5 py-0"}),(0,r.jsxs)("span",{className:"text-xs text-muted-foreground",children:["SLA: ",e.slaTarget]})]})]}),(0,r.jsx)("select",{value:e.status,onChange:t=>n(e.id,t.target.value),className:"flex h-8 rounded-md border border-input bg-background px-2 py-1 text-xs",children:ev.map(e=>(0,r.jsx)("option",{value:e,children:e},e))})]},e.id))})})]},e))]})}function eN(e){let{id:t}=e,[n,s]=(0,i.useState)(null),[a,c]=(0,i.useState)(!0),[l,d]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{try{let e=(0,_.AZ)(t);e?s(e):d(!0)}catch(e){console.error("Failed to load assessment:",e),d(!0)}finally{c(!1)}},[t]),a)?(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsx)("p",{className:"text-muted-foreground text-lg",children:"Loading remediation plan..."})}):l||!n?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-destructive",children:"Assessment Not Found"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:['The assessment with ID "',t,'" could not be found.']}),(0,r.jsx)(Y.default,{href:"/",children:(0,r.jsx)(o.z,{variant:"outline",children:"Back to Dashboard"})})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:["Remediation Plan â€” ",n.projectName]}),(0,r.jsx)(Y.default,{href:"/assess/?id=".concat(t),children:(0,r.jsx)(o.z,{variant:"outline",children:"Back to Results"})})]}),(0,r.jsx)(eb,{items:n.remediationPlan,onStatusChange:(e,t)=>{if(!n)return;let r=n.remediationPlan.map(n=>n.id===e?{...n,status:t}:n),i={...n,remediationPlan:r};(0,_.Re)(i),s(i)}})]})}let ek=[{value:"markdown",label:"Markdown",description:"Plain text format, ideal for version control and documentation."},{value:"pdf",label:"PDF",description:"Print-ready format for stakeholder distribution."}];function ew(e){let{selected:t,onSelect:n}=e;return(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{children:(0,r.jsx)(a.ll,{className:"text-lg",children:"Export Format"})}),(0,r.jsx)(a.aY,{className:"space-y-2",children:ek.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>n(e.value),className:(0,c.cn)("w-full rounded-md border p-3 text-left transition-colors",t===e.value?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:e.label}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:e.description})]},e.value))})]})}let eC=[{value:"executive",label:"Executive Summary",description:"High-level overview with scores and key recommendations for leadership."},{value:"technical",label:"Technical Detail",description:"Full findings with file references, framework mappings, and fix guidance."},{value:"full",label:"Full Report",description:"Complete report combining executive summary and technical details."}];function eS(e){let{selected:t,onSelect:n}=e;return(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{children:(0,r.jsx)(a.ll,{className:"text-lg",children:"Report View"})}),(0,r.jsx)(a.aY,{className:"space-y-2",children:eC.map(e=>(0,r.jsxs)("button",{type:"button",onClick:()=>n(e.value),className:(0,c.cn)("w-full rounded-md border p-3 text-left transition-colors",t===e.value?"border-primary bg-primary/5":"border-border hover:bg-muted/50"),children:[(0,r.jsx)("p",{className:"text-sm font-medium",children:e.label}),(0,r.jsx)("p",{className:"text-xs text-muted-foreground mt-0.5",children:e.description})]},e.value))})]})}function eP(e){let{content:t,format:n}=e;return(0,r.jsxs)(a.Zb,{children:[(0,r.jsx)(a.Ol,{children:(0,r.jsx)(a.ll,{className:"text-lg",children:"Preview"})}),(0,r.jsx)(a.aY,{children:"pdf"===n?(0,r.jsx)("p",{className:"text-sm text-muted-foreground",children:"PDF preview is not available. The report will open in a new window for printing or saving as PDF."}):(0,r.jsx)("pre",{className:"max-h-[500px] overflow-auto rounded-md bg-muted p-4 text-xs font-mono whitespace-pre-wrap",children:t||"No content to preview."})})]})}function eI(e){return e>=80?"PASS":e>=50?"NEEDS IMPROVEMENT":"FAIL"}function eA(e){let{scores:t,findings:n}=e,r=function(e){let t={P0:0,P1:0,P2:0,P3:0};for(let n of e)t[n.priority]++;return t}(n),s=["**Project:** ".concat(e.projectName),"**Date:** ".concat(new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),"**Overall Compliance Score:** ".concat(t.overall,"% (").concat(eI(t.overall),")"),"","### Category Scores","","| Category | Score | Status |","|----------|-------|--------|","| Security | ".concat(t.security,"% | ").concat(eI(t.security)," |"),"| Quality | ".concat(t.quality,"% | ").concat(eI(t.quality)," |"),"| Operations | ".concat(t.operations,"% | ").concat(eI(t.operations)," |"),"| Governance | ".concat(t.governance,"% | ").concat(eI(t.governance)," |")],i=["### Risk Summary","","| Priority | Count | Description |","|----------|-------|-------------|","| P0 Critical | ".concat(r.P0," | Immediate action required |"),"| P1 High | ".concat(r.P1," | Address in Sprint 1 |"),"| P2 Medium | ".concat(r.P2," | Address in Sprint 2 |"),"| P3 Low | ".concat(r.P3," | Address in Sprint 3 |"),"","**Total Findings:** ".concat(n.length)],o=n.filter(e=>"P0"===e.priority),a=[];if(o.length>0)for(let e of(a.push("### Critical Issues Requiring Immediate Action"),a.push(""),o))a.push("- **".concat(e.title,"**: ").concat(e.riskStatement));else a.push("### Critical Issues"),a.push(""),a.push("No critical (P0) issues found.");let c=["### Recommendations","",r.P0>0?"1. **Immediate:** Address all P0 critical security findings before any deployment.":"1. **Positive:** No critical security issues detected.",r.P1>0?"2. **Short-term:** Plan Sprint 1 to resolve P1 high-priority items, focusing on security and quality gaps.":"2. **Positive:** No high-priority issues requiring immediate sprint planning.","3. **Medium-term:** Establish CI/CD quality gates to prevent regression on resolved items.","4. **Ongoing:** Schedule quarterly compliance re-assessments to track improvement."];return[{title:"Executive Overview",content:s.join("\n"),order:1},{title:"Risk Summary",content:i.join("\n"),order:2},{title:"Critical Issues",content:a.join("\n"),order:3},{title:"Recommendations",content:c.join("\n"),order:4}]}let eE={security:"Security",quality:"Quality",operations:"Operations",governance:"Governance"},eR={P0:"P0 Critical",P1:"P1 High",P2:"P2 Medium",P3:"P3 Low"};function eO(e){let t=[];if(t.push("#### ".concat(e.title)),t.push(""),t.push("- **Priority:** ".concat(eR[e.priority])),t.push("- **Category:** ".concat(eE[e.category])),e.fileRef&&t.push("- **Location:** `".concat(e.fileRef).concat(e.lineRef?":".concat(e.lineRef):"","`")),t.push("- **Risk:** ".concat(e.riskStatement)),e.frameworkRefs.length>0){let n=e.frameworkRefs.map(e=>"".concat(e.controlId," (").concat(e.controlName,")")).join(", ");t.push("- **Framework References:** ".concat(n))}return e.antiPatternId&&t.push("- **Anti-Pattern:** ".concat(e.antiPatternId)),t.push(""),t.push("**Description:** ".concat(e.description)),t.push(""),t.push("**Recommended Fix:** ".concat(e.fixRecommendation)),t.push(""),t.push("**Verification:** ".concat(e.verificationMethod)),t.push(""),t.push("---"),t.join("\n")}function eD(e){let{findings:t,scores:n}=e,r=[],s=1,i=["### Framework Compliance Scores",""];for(let[,e]of(i.push("| Framework | Score | Passing | Failing | Total |"),i.push("|-----------|-------|---------|---------|-------|"),Object.entries(n.frameworkScores)))e.totalControls>0&&i.push("| ".concat(e.frameworkId," | ").concat(e.score,"% | ").concat(e.passingControls," | ").concat(e.failingControls," | ").concat(e.totalControls," |"));for(let e of(r.push({title:"Framework Compliance",content:i.join("\n"),order:s++}),["security","quality","operations","governance"])){let n=t.filter(t=>t.category===e);if(0===n.length){r.push({title:"".concat(eE[e]," Findings"),content:"No ".concat(e," findings detected."),order:s++});continue}let i=[...n].sort((e,t)=>{let n={P0:0,P1:1,P2:2,P3:3};return n[e.priority]-n[t.priority]}).map(eO).join("\n");r.push({title:"".concat(eE[e]," Findings (").concat(n.length,")"),content:i,order:s++})}let o=t.filter(e=>e.antiPatternId);if(o.length>0){let e=o.map(eO).join("\n");r.push({title:"Vibe-Code Anti-Patterns Detected (".concat(o.length,")"),content:e,order:s++})}return r}function eT(e,t){let n=[...function(e,t){switch(t){case"executive":return eA(e);case"technical":return eD(e);default:return[...eA(e),...eD(e)]}}(e,t)].sort((e,t)=>e.order-t.order),r=["# SDLC Compliance Report: ".concat(e.projectName),"","> Generated on ".concat(new Date(e.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})),"> Overall Score: **".concat(e.scores.overall,"%**"),"","---",""];for(let e of n)r.push("## ".concat(e.title)),r.push(""),r.push(e.content),r.push("");return"executive"!==t&&r.push(function(e){if(0===e.remediationPlan.length)return"";let t=["","## Remediation Plan","","| # | Finding | Priority | SLA | Status |","|---|---------|----------|-----|--------|"];for(let n=0;n<e.remediationPlan.length;n++){let r=e.remediationPlan[n];t.push("| ".concat(n+1," | ").concat(r.title," | ").concat(r.priority," | ").concat(r.slaTarget," | ").concat(r.status," |"))}return t.join("\n")}(e)),r.push(""),r.push("---"),r.push(""),r.push("*Report generated by SDLC Compliance Auditor*"),r.join("\n")}async function eM(e,t){let n;let r=eT(e,t).replace(/^#### (.+)$/gm,"<h4>$1</h4>").replace(/^### (.+)$/gm,"<h3>$1</h3>").replace(/^## (.+)$/gm,"<h2>$1</h2>").replace(/^# (.+)$/gm,"<h1>$1</h1>").replace(/^> (.+)$/gm,"<blockquote>$1</blockquote>").replace(/^---$/gm,"<hr>").replace(/\*\*(.+?)\*\*/g,"<strong>$1</strong>").replace(/`([^`]+)`/g,"<code>$1</code>").replace(/(?:^\|.+\|$\n?)+/gm,e=>{let t=e.trim().split("\n");if(t.length<2)return e;let n="<table>",r=t[0].split("|").filter(e=>e.trim()).map(e=>"<th>".concat(e.trim(),"</th>")).join("");n+="<thead><tr>".concat(r,"</tr></thead><tbody>");for(let e=2;e<t.length;e++){let r=t[e].split("|").filter(e=>e.trim()).map(e=>"<td>".concat(e.trim(),"</td>")).join("");n+="<tr>".concat(r,"</tr>")}return n+"</tbody></table>"}).replace(/^- (.+)$/gm,"<li>$1</li>").replace(/(<li>.*<\/li>\n?)+/g,"<ul>$&</ul>").replace(/^\d+\. (.+)$/gm,"<li>$1</li>").replace(/^(?!<[a-z]).+$/gm,e=>e.trim()?"<p>".concat(e,"</p>"):"").replace(/\n{3,}/g,"\n\n"),s=window.open("","_blank");if(!s)throw Error("Could not open print window. Please allow pop-ups and try again.");s.document.write('\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <title>SDLC Compliance Report - '.concat(e.projectName,"</title>\n  <style>\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n      line-height: 1.6;\n      color: #1a1a1a;\n      max-width: 800px;\n      margin: 0 auto;\n      padding: 40px 20px;\n    }\n    h1 { font-size: 24px; border-bottom: 2px solid #333; padding-bottom: 8px; }\n    h2 { font-size: 20px; border-bottom: 1px solid #ddd; padding-bottom: 4px; margin-top: 32px; }\n    h3 { font-size: 16px; margin-top: 24px; }\n    h4 { font-size: 14px; margin-top: 16px; }\n    table { border-collapse: collapse; width: 100%; margin: 16px 0; font-size: 13px; }\n    th, td { border: 1px solid #ddd; padding: 8px 12px; text-align: left; }\n    th { background-color: #f5f5f5; font-weight: 600; }\n    code { background: #f4f4f4; padding: 2px 6px; border-radius: 3px; font-size: 13px; }\n    blockquote { border-left: 4px solid #ddd; margin: 16px 0; padding: 8px 16px; color: #555; }\n    hr { border: none; border-top: 1px solid #ddd; margin: 24px 0; }\n    ul, ol { padding-left: 24px; }\n    li { margin-bottom: 4px; }\n    strong { font-weight: 600; }\n    @media print {\n      body { padding: 0; }\n      h2 { page-break-before: auto; }\n      table { page-break-inside: avoid; }\n    }\n  </style>\n</head>\n<body>\n  ").concat(r,"\n</body>\n</html>\n  ")),s.document.close(),await new Promise(e=>{s.onload=()=>e(),setTimeout(e,500)}),s.print()}function eL(e){let{id:t}=e,[n,s]=(0,i.useState)(null),[a,c]=(0,i.useState)(!0),[l,d]=(0,i.useState)(!1),[u,p]=(0,i.useState)("markdown"),[m,f]=(0,i.useState)("full"),[h,g]=(0,i.useState)(""),[x,y]=(0,i.useState)(!1);(0,i.useEffect)(()=>{try{let e=(0,_.AZ)(t);e?s(e):d(!0)}catch(e){console.error("Failed to load assessment:",e),d(!0)}finally{c(!1)}},[t]),(0,i.useEffect)(()=>{n&&g(eT(n,m))},[n,m]);let j=async()=>{if(n){y(!0);try{if("markdown"===u){let e=eT(n,m),t=new Blob([e],{type:"text/markdown"}),r=URL.createObjectURL(t),s=document.createElement("a");s.href=r,s.download="".concat(n.projectName,"-compliance-report.md"),document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(r)}else await eM(n,m)}catch(e){console.error("Export failed:",e)}finally{y(!1)}}};return a?(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsx)("p",{className:"text-muted-foreground text-lg",children:"Loading export..."})}):l||!n?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-20 space-y-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-destructive",children:"Assessment Not Found"}),(0,r.jsxs)("p",{className:"text-muted-foreground",children:['The assessment with ID "',t,'" could not be found.']}),(0,r.jsx)(Y.default,{href:"/",children:(0,r.jsx)(o.z,{variant:"outline",children:"Back to Dashboard"})})]}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("h1",{className:"text-3xl font-bold tracking-tight",children:["Export Report â€” ",n.projectName]}),(0,r.jsx)(Y.default,{href:"/assess/?id=".concat(t),children:(0,r.jsx)(o.z,{variant:"outline",children:"Back to Results"})})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsx)(ew,{selected:u,onSelect:p}),(0,r.jsx)(eS,{selected:m,onSelect:f})]}),(0,r.jsx)(eP,{content:h,format:u}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)(o.z,{size:"lg",onClick:j,disabled:x,children:x?"Exporting...":"Download ".concat("pdf"===u?"PDF":"Markdown")})})]})}function eF(){let e=(0,s.useSearchParams)(),t=e.get("id"),n=e.get("view");return t?"remediate"===n?(0,r.jsx)(eN,{id:t}):"export"===n?(0,r.jsx)(eL,{id:t}):(0,r.jsx)(ex,{id:t}):(0,r.jsx)(Z,{})}function eU(){return(0,r.jsx)(i.Suspense,{fallback:(0,r.jsx)("div",{className:"flex items-center justify-center py-20",children:(0,r.jsx)("p",{className:"text-muted-foreground text-lg",children:"Loading..."})}),children:(0,r.jsx)(eF,{})})}},5503:function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var r=n(7437),s=n(3448);function i(e){let{score:t,label:n}=e,i=Math.max(0,Math.min(100,t)),o=2*Math.PI*70;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center",children:[(0,r.jsxs)("div",{className:"relative h-44 w-44",children:[(0,r.jsxs)("svg",{className:"h-full w-full -rotate-90",viewBox:"0 0 160 160",xmlns:"http://www.w3.org/2000/svg",children:[(0,r.jsx)("circle",{cx:"80",cy:"80",r:70,fill:"none",strokeWidth:10,className:"stroke-muted"}),(0,r.jsx)("circle",{cx:"80",cy:"80",r:70,fill:"none",strokeWidth:10,strokeLinecap:"round",strokeDasharray:o,strokeDashoffset:o-i/100*o,className:(0,s.cn)("transition-all duration-700 ease-out",i>=80?"stroke-green-500":i>=50?"stroke-yellow-500":"stroke-red-500")})]}),(0,r.jsx)("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:(0,r.jsx)("span",{className:(0,s.cn)("text-4xl font-bold tabular-nums",i>=80?"text-green-500":i>=50?"text-yellow-500":"text-red-500"),children:i})})]}),(0,r.jsx)("span",{className:"mt-2 text-sm font-medium text-muted-foreground",children:n})]})}},2381:function(e,t,n){"use strict";n.d(t,{z:function(){return l}});var r=n(7437),s=n(2265),i=n(7053),o=n(535),a=n(3448);let c=(0,o.j)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),l=s.forwardRef((e,t)=>{let{className:n,variant:s,size:o,asChild:l=!1,...d}=e,u=l?i.g7:"button";return(0,r.jsx)(u,{className:(0,a.cn)(c({variant:s,size:o,className:n})),ref:t,...d})});l.displayName="Button"},7204:function(e,t,n){"use strict";n.d(t,{E:function(){return a}});var r=n(7437),s=n(2265),i=n(1505),o=n(3448);let a=s.forwardRef((e,t)=>{let{className:n,value:s,...a}=e;return(0,r.jsx)(i.fC,{ref:t,className:(0,o.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",n),...a,children:(0,r.jsx)(i.z$,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(s||0),"%)")}})})});a.displayName=i.fC.displayName},8854:function(e,t,n){"use strict";n.d(t,{AZ:function(){return o},Nv:function(){return a},Ox:function(){return c},Re:function(){return i}});let r="sdlc-auditor-assessments";function s(){try{let e=window.localStorage.getItem(r);if(!e)return{};return JSON.parse(e)}catch(e){return{}}}function i(e){let t=s();t[e.id]=e,function(e){try{window.localStorage.setItem(r,JSON.stringify(e))}catch(e){console.error("[sdlc-auditor] Failed to write to localStorage")}}(t)}function o(e){var t;return null!==(t=s()[e])&&void 0!==t?t:null}function a(){return Object.values(s()).sort((e,t)=>{var n,r;let s=new Date(null!==(n=e.updatedAt)&&void 0!==n?n:e.createdAt).getTime();return new Date(null!==(r=t.updatedAt)&&void 0!==r?r:t.createdAt).getTime()-s})}function c(){if("undefined"!=typeof crypto&&"function"==typeof crypto.randomUUID)return crypto.randomUUID();let e=()=>Math.floor(65536*Math.random()).toString(16).padStart(4,"0");return"".concat(e()).concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e(),"-").concat(e()).concat(e()).concat(e())}}},function(e){e.O(0,[137,648,468,719,187,971,117,744],function(){return e(e.s=4520)}),_N_E=e.O()}]);